\documentclass[12pt,letterpaper]{report}

\input{co456_preamble}

%---------------
\begin{document}
%--------------

%%%%% Title
\title{
  \Huge
  \textbf{CO 456: Introduction to Game Theory} \\[\baselineskip]
  \large
  University of Waterloo \\
  Martin Pei \\
  Fall 2020
}
\author{Marco Yang}
\date{Last updated: \today}

{
  \sffamily
  \maketitle
}
\thispagestyle{empty}

%%%%% Table of contents
\pagebreak
\pagenumbering{roman}
\setcounter{page}{2}

{
  \sffamily
  \tableofcontents{\markboth{\contentsname}{}}
}

%%%%% Lectures
\pagebreak
\pagenumbering{arabic}

%%%%% Lec 1
\section{Course Administration}

\subsection{Overview}

Planned topics:
\begin{enumerate}
  \item Combinatorial games
  \item Strategic games
  \item Mechanism design
  \item Cooperative games
\end{enumerate}

\subsection{Instructor}

Martin Pei (\texttt{mpei}).

\subsection{Assignments}

Roughly 30-40 assignment problems, up to 4 per week.
Due Fridays at 11:59 pm Eastern on Crowdmark.
All equally weighted, marked out of 10.

\subsection{Exams}

Three term tests and a final exam.
\begin{itemize}
  \item Term test 1: Wednesday, October 7, 12:01 am to 11:59 pm EDT
  \item Term test 2: Wednesday, November 11, 12:01 am to 11:59 pm EST
  \item Term test 3: Wednesday, December 2, 12:01 am to 11:59 pm EST
  \item Final exam: scheduled during final exam period (December 9-23)
\end{itemize}
Each term test is allotted 2.5 hours within the 24-hour window (student's choice).
Final exam is allotted 3 hours within its 24-hour window (student's choice).
Open book.

\subsection{Grading}

\begin{itemize}
  \item 40\% assignment problems (lowest 7 dropped)
  \item Best 3 of 4 assessments:
    \begin{itemize}
      \item 20\% term test 1
      \item 20\% term test 2
      \item 20\% term test 3
      \item 20\% final exam
    \end{itemize}
\end{itemize}

%%%%% Topic: Combinatorial Games
\coursetopic{Combinatorial Games}

%%%%% Lec 2
\section{Impartial Games}

\subsection{Nim}

We are given some piles of chips.
Two players play alternately.
On a player's turn, they pick a pile and remove at least 1 chip from it.
The first player who cannot make a move loses.

\begin{ex}
  \begin{itemize}
    \item
      1, 1, 2.
      \begin{itemize}
        \item Player I removes 2 chips from the last pile.
        \item Player II removes a 1-chip pile.
        \item Player I removes the last chip.
        \item Player II has no move and loses.
        \item Player I has a winning strategy.
      \end{itemize}
      This is a \hldef{winning game} or \hldef{winning position}.
    \item
      5, 5.
      \begin{itemize}
        \item Regardless of Player I's move, Player II can mirror it on the other pile.
        \item Player II always has a move, so Player I loses.
        \item Player I always loses (\emph{i.e.} Player II has a winning strategy).
      \end{itemize}
      This is a \hldef{losing game} or \hldef{losing position}.
    \item
      5, 7.
      \begin{itemize}
        \item Player I first equalizes piles (here, removing 2 from the pile of 7).
        \item Player II loses (by the previous case).
      \end{itemize}
      This is a winning game.
  \end{itemize}
\end{ex}

\begin{lem}{}{2.1}
  In instances of Nim with two piles of $n, m$ chips, it is a winning game if and only if
  $n \neq m$.
\end{lem}

\pagebreak
\subsection{Impartial games}

Nim is an impartial game.

\begin{defn}{impartial game}{impartial_game}
  Conditions for an \hldef{impartial game}:
  \begin{enumerate}
    \item There are two players, Player I (who starts) and Player II.
    \item There are several positions and a starting position.
    \item A player performs one of a set of allowable moves, which depends only on the current
      position and not on the player (hence ``impartial'').
      Each possible move generates an \hldef{option}.
    \item The players move alternately.
    \item There is complete information.
    \item There are no chance moves.
    \item The first player with no available move loses.
    \item The rules guarantee that games end.
  \end{enumerate}
\end{defn}

\begin{ex}
  Games which are not impartial:
  \begin{itemize}
    \item Tic-tac-toe (violates 7---may tie)
    \item Chess (violates 3---may only move your pieces)
    \item Poker (violates 5---cards hidden)
    \item Monopoly (violates 6---relies on dice rolls)
  \end{itemize}
\end{ex}

\begin{ex}
  Let $G = (1, 1, 2)$ be a Nim game.
  There are 4 possible moves, hence 4 possible options.

  \begin{center}
    \begin{forest}
      for tree={draw, rectangle, parent anchor=east, child anchor=west, edge={->}},
      l sep=2cm
      [{$G = (1, 1, 2)$}, grow'=east
        [{$H_1 = (1, 1, 1)$}]
        [{$H_2 = (1, 1, 0)$}]
        [{$H_3 = (1, 0, 2)$}]
        [{$H_4 = (0, 1, 2)$}]
      ]
    \end{forest}
  \end{center}

  Each $H_i$ is itself another Nim game.
\end{ex}

Note: we can define an impartial game by its position and options recursively.

\begin{defn}{game simplicity}{game_simple}
  A game $H$ that is reachable from game $G$ by a sequence of allowable moves is \hldef{simpler}
  than $G$.
\end{defn}

\begin{ex}
  Other impartial games:
  \begin{itemize}
    \item
      Subtraction game
      \begin{itemize}
        \item One pile of chips.
        \item Valid move: remove 1, 2, or 3 chips.
      \end{itemize}
    \item
      Rook game
      \begin{itemize}
        \item $m \times n$ chess board with a rook at $(i, j)$.
        \item Valid move: move the rook any number of spaces up or left.
      \end{itemize}
    \item
      Green hackenbush game
      \begin{itemize}
        \item Graph connected to the floor at some vertices.
        \item Valid move: remove an edge of the graph, then any components no longer connected to
          the floor.
      \end{itemize}
  \end{itemize}
\end{ex}

Spoiler: all impartial games are essentially Nim games.

\pagebreak
\subsection{Winning strategy}

\begin{lem}{}{2.2}
  In any game $G$, either Player I or Player II has a winning strategy.
\end{lem}

\begin{thmproof}
  By induction on simplicity of $G$.

  If $G$ has no allowable moves, then Player I loses, so Player II has a winning strategy.
  Assume $G$ has allowable moves and the lemma holds for all games simpler than $G$.
  Among all options of $G$, if Player I has a winning strategy in one of them, Player I will move to
  that option and win.
  Otherwise, Player II has a winning strategy for all options, so Player II wins regardless of
  Player I's move.
\end{thmproof}

That is, every impartial game $G$ is either a winning game or a losing game.

\begin{ex}
  Winning game of Nim (at least one winning move):
  \begin{center}
    \begin{forest}
      l sep=30pt,
      s sep=20pt
      [{$(5, 7)$}
        [{$(5, 5)$}, edge={->},
          edge label={node[midway, left, xshift=-1em, font=\footnotesize]{winning move}}]
        [{$(5, 6)$}, edge={->, dashed}]
        [{$(5, 7)$}, edge={->, dashed}]
        [{$\phantom{(}\cdots$\phantom{)}}, edge={->, dashed},
          edge label={node[midway, right, xshift=1em, font=\footnotesize]{non-winning moves}}]
      ]
    \end{forest}
  \end{center}

  Losing game of Nim (no winning moves):
  \begin{center}
    \begin{forest}
      l sep=30pt,
      s sep=20pt
      [{$(5, 5)$}
        [{$(4, 5)$}, edge={->, dashed}]
        [{$(3, 5)$}, edge={->, dashed}]
        [{$\phantom{(}\cdots$\phantom{)}}, edge={->, dashed}]
        [{$(5, 4)$}, edge={->, dashed}]
        [{$(5, 3)$}, edge={->, dashed}]
        [{$\phantom{(}\cdots$\phantom{)}}, edge={->, dashed}, edge label={
          node[midway, right, xshift=2em, font=\footnotesize]{non-winning moves}}]
      ]
    \end{forest}
  \end{center}
\end{ex}

Note: we assume players play perfectly.
If there is a winning move, then they will take it.

%%%%% Lec 3
\section{Equivalent Games (I)}

\subsection{Game sums}

\begin{defn}{game sum}{game_sum}
  Let $G$ and $H$ be two games with respective options $G_1, \ldots, G_m$ and $H_1, \ldots, H_n$.
  We define \hldef{$G + H$} as the game with options
  \[
    G_1 + H, \ldots, G_m + H, G + H_1, \ldots, G + H_n.
  \]
\end{defn}

\begin{ex}
  We denote \hldef{$*n$} to be a game of Nim with one pile of $n$ chips.
  Then $*1 + *1 + *2$ is a Nim game with three piles of 1, 1, and 2 chips.
\end{ex}

\begin{ex}
  Let \hldef{$\#n$} be the subtraction game with $n$ chips.
  Then $*5 + \#7$ is the game where a move is either to remove at least 1 chip from the pile of 5
  (Nim) or to remove 1, 2, or 3 chips from the pile of 7 (subtraction game).
\end{ex}

\begin{lem}{}{3.1}
  Let $\mathcal{G}$ be the set of all impartial games.
  Then for all $G, H, J \in \mathcal{G}$,
  \begin{enumerate}
    \item $G + H \in \mathcal{G}$ (closure)
    \item $(G + H) + J = G + (H + J)$ (associativity)
    \item There exists an identity $0 \in \mathcal{G}$ (the game with no options) where
      $G + 0 = 0 + G = G$.
    \item $G + H = H + G$ (symmetry)
  \end{enumerate}
\end{lem}

Note: $\mathcal{G}$ is an abelian group, except for an inverse element.

\pagebreak
\subsection{Game equivalences}

\begin{defn}{game equivalence}{game_equiv}
  Two games $G$ and $H$ are \hldef{equivalent} if for any game $J$, $G + J$ and $H + J$ have the
  same outcome (\emph{i.e.}, both are winning games or both are losing games).
  Notation: $G \equiv H$.
\end{defn}

\begin{ex}
  $*3 \equiv *3$.
  Since $*3 + J$ is the same game as $*3 + J$, they have the same outcome.

  $*3 \not\equiv *4$.
  $*3 + *3$ is a winning game but $*4 + *3$ is a losing game (\cref{lem:2.1}).
\end{ex}

\begin{lem}{}{3.2}
  $*n \equiv *m$ if and only if $n = m$.
\end{lem}

\begin{lem}{}{3.3}
  The relation $\equiv$ is an equivalence relation.
  That is, for all $G, H, K \in \mathcal{G}$,
  \begin{enumerate}
    \item $G \equiv G$ (reflexivity).
    \item $G \equiv H$ if and only if $H \equiv G$ (symmetry).
    \item If $G \equiv H$ and $H \equiv J$, then $G \equiv J$ (transitivity).
  \end{enumerate}
\end{lem}

\begin{exer}{}{3.4}
  Prove that if $G \equiv H$, then $G + J \equiv H + J$ for any game $J$.
\end{exer}

\begin{exerproof}
  Consider any games $J$ and $K$.
  Let $M = J + K$.
  Then $G + J + K = G + M$ and $H + J + K = H + M$.
  Since $G \equiv H$, $G + M$ and $H + M$ have the same outcome.
  But then $(G + J) + K$ and $(H + J) + K$ have the same outcome by \cref{lem:3.1}.
  $K$ was arbitrary, so $G + J \equiv H + J$.
\end{exerproof}

\pagebreak
\subsection{Losing games and empty Nim}

Nim with one pile $*n$ is a losing game if and only if $n = 0$.

\begin{thm}{}{3.5}
  $G$ is a losing game if and only if $G \equiv *0$.
\end{thm}

\begin{cor}{}{3.6}
  If $G$ is a losing game, then $J$ and $J + G$ have the same outcome for any game $J$.
\end{cor}

\begin{thmproof}
  Since $G$ is a losing game, $G \equiv *0$ by \cref{thm:3.5}.
  Then $J + G \equiv J + *0 \equiv J$ by \cref{exer:3.4} and \cref{lem:3.1}, so $J$ and $J + G$ have
  the same outcome.
\end{thmproof}

\begin{ex}
  \begin{enumerate}
    \item
      Recall $*5 + *5$ and $*7 + *7$ are losing games.
      \cref{cor:3.6} says $*5 + *5 + *7 + *7$ is also a losing game.
      (Player I moves in either $*5 + *5$ or $*7 + *7$.
      Player II plays a winning move in the same part by equalizing piles.)
    \item
      $\underbrace{*1 + *1 + *2}_{\text{winning}} + \underbrace{*5 + *5}_{\text{losing}}$ is a
      winning game by \cref{cor:3.6}.
      (Player I removes $*2$, leaving a similar game to the previous.)
  \end{enumerate}
\end{ex}

\begin{thmproof}[Proof (\cref{thm:3.5}).]
  \begin{itemize}[leftmargin=4em]
    \item[$(\impliedby)$]
      If $G \equiv *0$, then $G + *0$ has the same outcome as $*0 + *0$.
      But $*0 + *0$ is a losing game, so $G$ is a losing game.
    \item[$(\implies)$]
      Suppose $G$ is a losing game.
      We show $G + J$ and $*0 + J \equiv J$ have the same outcome.
      \begin{enumcase}
        \item
          Suppose $J$ is a losing game.
          We show ``if $G$ and $J$ are both losing games, then $G + J$ is a losing game'' by
          induction on simplicity of $G + J$.

          When $G + J$ has no options, $G$ and $J$ have no options, so $G$, $J$, and $G + J$ are all
          losing games.
          Assume $G + J$ has some otpions and the statement holds for simpler games.
          WLOG, Player I moves on $G$, resulting in $G' + J$.
          $G$ is a losing game, so $G'$ is a winning game.
          Player II makes a winning move from $G'$ to $G''$, resulting in $G'' + J$.
          Then $G''$ is a losing game, so by induction $G'' + J$ is a losing game.
          Player I loses, so $G + J$ is a losing game.
        \item
          Suppose $J$ is a winning game, so $J$ as a winning move to $J'$.
          Player I moves from $G + J$ to $G + J'$.
          $G$ and $J'$ are both losing games, so by \circled{1} $G + J'$ is a losing game.
          Player II loses, so Player I wins and $G + J$ is a winning game.
      \end{enumcase}
  \end{itemize}
\end{thmproof}

%%%%% Lec 4
\section{Equivalent Games (II)}

\begin{lem}{copycat principle}{4.1}
  For any game $G$, $G + G \equiv *0$.
\end{lem}

\begin{thmproof}
  By induction on the simplicity of $G$.

  When $G$ has no options, $G + G$ has no options, so $G + G \equiv *0$ by \cref{lem:4.1}.

  Suppose $G$ has options, and WLOG suppose Player I moves from $G + G$ to $G' + G$.
  Then Player II can move to $G' + G'$.
  By induction, $G' + G' \equiv *0$, so it is a losing game for Player I.
  Therefore, $G + G$ is a losing game, and $G + G \equiv *0$.
\end{thmproof}

Aside: this means $G$ is its own ``inverse''.

\begin{lem}{}{4.2}
  $G \equiv H$ if and only if $G + H \equiv *0$.
\end{lem}

\begin{thmproof}
  \begin{itemize}[leftmargin=4em]
    \item[($\implies$)]
      From $G \equiv H$, we add $H$ to both sides to get $G + H \equiv H + H \equiv *0$ by the
      \hyperref[lem:4.1]{copycat principle}.
    \item[($\impliedby$)]
      From $G + H \equiv *0$, we add $H$ to both sides to get $G + H + H \equiv *0 + H \equiv H$.
      But $G + H + H \equiv G + *0 \equiv G$ by the \hyperref[thm:3.5]{copycat principle}, so
      $G \equiv H$.
  \end{itemize}
\end{thmproof}

\begin{ex}
  $*1 + *2 + *3$ is a losing game, so $*1 + *2 + *3 \equiv *0$.
  By \cref{lem:4.2}, $*1 + *2 \equiv *3$.
  Or, $*1 + *3 \equiv *2$.
\end{ex}

Another way to prove game equivalence is by showing that they have equivalent options.

\begin{lem}{}{4.3}
  If the options of $G$ are equivalent to the options of $H$, then $G \equiv H$.
  (More precisely: there is a bijection between options of $G$ and $H$ where paired options are
  equivalent.)
\end{lem}

\begin{ex}
  We can show $*1 + *2 \equiv *3$ by \cref{lem:4.3}:
  \[
    \begin{array}{c c c}
      *1 + *2 & & *3 \\
      \hline
      *2 & \equiv & *2 \\
      *1 & \equiv & *1 \\
      *1 + *1 & \equiv & *0 \\
    \end{array}
  \]
\end{ex}

Note: the converse of \cref{lem:4.3} is false.

\begin{thmproof}[Proof (\cref{lem:4.3}).]
  It suffices to show that $G + H \equiv *0$ (by \cref{lem:4.2}), \emph{i.e.}, $G + H$ is a losing
  game.
  This is true when $G$ and $H$ both have no options.
  Suppose that $G$ and $H$ have options and suppose WLOG Player I moves to $G' + H$.
  By assumption, there exists an option of $H$, say $H'$, where $H' \equiv G'$.
  So Player II can move to $G' + H'$.
  Since $G' \equiv H'$, $G' + H' \equiv *0$ by \cref{lem:4.2}.
  So $G' + H'$ is a losing game for Player I.
  Hence $G + H$ is a losing game.
\end{thmproof}

%%%%% Lec 5
\section{Nim and Nimbers (I)}

Goal: show that every Nim game is equivalent to a Nim game with a single pile.

\subsection{Nimbers}

\begin{defn}{nimber}{nimber}
  If $G$ is a game such that $G \equiv *n$ for some $n$, then $n$ is the \hldef{nimber} of $G$.
\end{defn}

\begin{ex}
  Any losing game has nimber $0$ (\cref{thm:3.5}).
\end{ex}

\begin{exer}{}{5.1}
  Show that the notion of a nimber is well-defined.
  (That is, every impartial game has exactly one nimber.)
\end{exer}

\begin{exerproof}[Proof (see P3(b)).]

\end{exerproof}

\begin{thm}{}{5.2}
  If $n = 2^{a_1} + 2^{a_2} + \cdots$ where $a_1 > a_2 > \cdots$, then
  $*n \equiv *2^{a_1} + *2^{a_2} + \cdots$.
\end{thm}

(The link to powers of $2$ is hard to explain; we'll revisit this later.)

\begin{ex}
  $11 = 2^3 + 2^1 + 2^0$ and $13 = 2^3 + 2^2 + 2^0$.
  Using \cref{thm:5.2}, $*11 \equiv *2^3 + *2^1 + *2^0$ and $*13 \equiv *2^3 + *2^2 + *2^0$.
  Then
  \begin{alignat*}{3}
    *11 + *13
    &\equiv (*2^3 + *2^1 + *2^0) + (*2^3 + *2^2 + *2^0) && \\
    &\equiv (*2^3 + *2^3) + *2^2 + *2^1 + (*2^0 + *2^0)
      \qquad & \text{(associativity, commutativity)} & \\
    &\equiv *0 + *2^2 + *2^1 + *0 & \text{(copycat principle)} && \\
    &\equiv *2^2 + *2^1 && \\
    &\equiv *(2^2 + 2^1) & \text{(\cref{thm:5.2})} &&\\
    &\equiv *6. &&
  \end{alignat*}
  So the nimber of $*11 + *13$ is $6$.
\end{ex}

In general, how can we find the nimber of $*b_1 + *b_2 + \cdots + *b_n$?
We look at the binary expansions of each $b_i$.
The copycat principle will cancel any pair of identical powers of $2$.
So, we should look for powers of $2$ that appear in an odd number of expansions of $b_i$'s.

We can use binary numbers: 11 in binary is 1011, 13 in binary is 1101.
Take the XOR of the binary representations:
\[
  \begin{array}{r r}
    \texttt{1011} & \\
    \xor\ \texttt{1101} & \\
    \cline{1-1}
    \texttt{0110} & = 6 \\
  \end{array}
\]
So $11 \xor 13 = 6$.

\begin{ex}
  Consider $*25 + *21 + *11$.
  The nimber of this game is given by the binary XOR of the numbers:
  \[
    \begin{array}{r}
      \texttt{11001} \\
      \texttt{10101} \\
      \xor\ \texttt{01011} \\
      \hline
      \texttt{00111} \\
    \end{array}
  \]
  So $*25 + *21 + *11 \equiv *7$ (the nimber is $7$).
\end{ex}

\begin{cor}{}{5.3}
  $*b_1 + *b_2 + \cdots + *b_n \equiv *(b_1 \xor b_2 \xor \cdots \xor b_n)$.
\end{cor}

This shows that every Nim game has a nimber.

\pagebreak
\subsection{Winning strategy for Nim}

\begin{ex}
  $*11 + *13 \equiv *6$.
  This is a winning game.
  How can we find a winning move?

  We want to move to a game that is equivalent to $*0$.
  We can add $*6$ to both sides: $*11 + *13 + *6 \equiv *6 + *6 \equiv *0$ (copycat principle).
  But this isn't a valid move.

  Consider $*11 + (*13 + *6)$.
  We see $13 \xor 6 = 11$.
  So this is equivalent to $*11 + *11$, a losing game.

  The winning move: remove 2 chips from the pile of 13.
\end{ex}

\begin{ex}
  $*25 + *21 + *11 \equiv *7$.
  Add $*7$ to both sides.
  Consider $*25 + (*21 + *7) + *11$.
  We see $21 \xor 7 = 18$, so this is equivalent to $*25 + *18 + *11$.

  The winning move: remove 3 chips from the pile of 21.

  Why did we pair $*7$ with $*21$ instead of $*25$ or $*11$?
  Those would be invalid moves: $25 \xor 7 = 30 > 25$ and $11 \xor 7 = 12 > 11$.
\end{ex}

Can we always pair the nimber with a pile such that the resulting equivalent game is simpler?
Yes.

\begin{lem}{}{5.4}
  If $*b_1 + \cdots + *b_n \equiv *s$ where $s > 0$, then there exists some $b_i$ where
  $b_i \xor s < b_i$.
\end{lem}

Proof idea: look for the largest power of 2 in $s$.
Consider $*25 + *21 + *11 \equiv *7$.
\begin{center}
  \begin{tabular}{c c c c c c r l}
     & \texttt{1} & \texttt{1} & \cellcolor{blue!20}\texttt{0} & \texttt{0} & \texttt{1}
      & \qquad\textcolor{gray}{25} & $25 \xor 7$: 4 is added \\
     & \texttt{1} & \texttt{0} & \cellcolor{blue!20}\texttt{1} & \texttt{0} & \texttt{1}
      & \qquad\textcolor{gray}{21} & $21 \xor 7$: 4 is subtracted \\
    $\xor$ & \texttt{1} & \texttt{1} & \cellcolor{blue!20}\texttt{0} & \texttt{0} & \texttt{1}
      & \qquad\textcolor{gray}{11} & $11 \xor 7$: 4 is added \\
    \cline{1-6}
     & \texttt{0} & \texttt{0} & \cellcolor{blue!20}\texttt{1} & \texttt{1} & \texttt{1}
      & \qquad\textcolor{gray}{7} & \\
     & & & \textcolor{gray}{$\uparrow$} & \textcolor{gray}{$\uparrow$}
      & \textcolor{gray}{$\uparrow$} & & \\
     & & & \textcolor{gray}{4} & \textcolor{gray}{2} & \textcolor{gray}{1}
      & $\leftarrow$ & $4 > 2 + 1$ so $\xor$ reduces 21 and increases 25 or 11 \\
  \end{tabular}
\end{center}

\begin{thmproof}[Proof (\cref{lem:5.4}).]
  Suppose $s = 2^{a_1} + 2^{a_2} + \cdots$ where $a_1 > a_2 > \cdots$.
  Then $2^{a_1}$ appears in the binary expansions of $b_1, \ldots, b_n$ an odd number of times (in
  particular, at least once).
  Let $b_i$ be one of them.
  Suppose $*b_i + *s \equiv *t$ for some $t$.
  Since $2^{a_1}$ is in the binary expansions of $b_i$ and $s$, $2^{a_1}$ is not in the binary
  expansion of $t$.
  For $2^{a_2}, 2^{a_3}, \ldots$, at worst none of them are in the binary expansion of $b_i$, so all
  of them are in the binary expansion of $t$.
  So $t \leq b_i - 2^{a_1} + 2^{a_2} + 2^{a_3} + \cdots < b_i$ since
  $2^{a_i} > 2^{a_2} + 2^{a_3} + \cdots$.
\end{thmproof}

Finding winning moves in a winning Nim game: Say a game has nimber $s$.
Look at the largest power of 2 in the binary expansion of $s$.
Pair it up with any pile $*b_i$ containing this power of 2.
By \cref{lem:5.4}, $s \xor b_i < b_i$.
So a winning move is taking away $b_i - (s \xor b_i)$ chips from the pile $*b_i$.

%%%%% Lec 6
\section{Nim and Nimbers (II)}

\begin{lem}[code={\setcounter{\tcbcounter}{1}}]{}{6.2}
  Let $0 \leq p, q < 2^a$ and suppose \cref{thm:5.2} holds for all values less than $2^a$.
  Then $p \xor q < 2^a$.
\end{lem}

\begin{thmproof}[Proof (exercise: see P3(c))]

\end{thmproof}

Illustration of proof of \cref{thm:5.2}: Consider $*7$.
$7 = 4 + 2 + 1$.
We want to prove $*7 \equiv *4 + *2 + *1$; by induction, $*2 + *1 \equiv *3$.
We want to show $*7 \equiv *4 + *3$.
By \cref{lem:4.3}, we can show the two sides have equivalent options.

Options of $*7$: $*0, *1, \ldots, *6$.

Options of $*4 + *3$: \circled{1} Move on $*4$. \quad \circled{2} Move on $*3$.

\begin{enumcase}
  \item
    Options are $*0 + *3$, $*1 + *3$, $*2 + *3$, $*3 + *3$.
    Each part is $< 4$, so by \cref{lem:6.2} each option is $< 4$.
    (Calculating them, we have $*3, *2, *1, *0$, so they are also distinct.)
  \item
    Options are $*4 + *2$, $*4 + *1$, $4 + *0$.
    Here, each first part is $4$ and each second part is $< 4$, so each power of 2 appears at most
    once among the two parts.
    We can apply induction here.
    (Calculating them, we have $*6, *5, *4$, which are exactly the remaining options of $*7$.)
\end{enumcase}

\begin{thmproof}[Proof (\cref{thm:5.2}).]
  By induction on $n$.

  When $n = 1$, $n = 2^0$ and $*1 \equiv *2^0$.

  Suppose $n = 2^{a_1} + 2^{a_2} + \cdots$ where $a_1 > a_2 > \cdots$.
  Let $q = n - 2^{a_1} = 2^{a_2} + 2^{a_3} + \cdots$.
  If $q = 0$, then $n = 2^{a_1}$, so $*n \equiv *2^{a_1}$ (\cref{lem:3.1}).
  Assume $q \geq 1$.
  Since $q < n$, by induction, $*q \equiv *2^{a_2} + *2^{a_3} + \cdots$.
  It remains to show that $*n \equiv *2^{a_1} + *q$.

  The options of $*n$ are $*0, *1, \ldots, *(n - 1)$.
  The options of $*2^{a_1} + *q$ can be partitioned into two types.
  \begin{enumcase}
    \item
      Consider options of the form $*i + *q$ where $0 \leq i < 2^{a_1}$.
      Since $i, q < n$, by induction, the theorem holds for $i$ and $q$.
      So $*i$ and $*q$ are equivalent to sums of Nim piles of their binary expansions.
      Using arguments from the last lecture (cancellation by copycat principle, as in
      \cref{cor:5.3}), $*i + *q \equiv *r_i$ where $r_i = i \xor q$.
      Since $i, q < 2^{a_1}$, we have $r_i < 2^{a_1}$ (\cref{lem:6.2}).
      So $0 \leq r_0, r_1, \ldots, r_{2^{a_1} - 1} < 2^{a_1}$.

      We now show these $r_i$'s are distinct.
      Suppose $r_i = r_j$ for some $i \neq j$.
      Then $*r_i \equiv *r_j$ (\cref{lem:3.2}), so $*i + *q \equiv *j + *q$.
      Adding $*q$ on both sides, we get $*i \equiv *j$ (copycat principle), so $i = j$.
      Contradiction.

      Finally, there are $2^{a_1}$ of the $r_i$'s and there are $2^{a_1}$ possible values ($0$ to
      $2^{a_1} - 1$).
      By pigeonhole, for each $0 \leq j \leq 2^{a_1} - 1$, there is exactly one $r_i$ with
      $r_i = j$.
      So the options of this type are equivalent to $\{*0, *1, \ldots, *2^{a_1} - 1\}$.
    \item
      Consider options of the form $*2^{a_1} + *i$ where $0 \leq i < q$.
      Suppose $i = 2^{b_1} + 2^{b_2} + \cdots$ where $b_1 > b_2 > \cdots$.
      Then no $b_i$ is equal to $a_1$.
      So $2^{a_1} + 2^{b_1} + 2^{b_2} + \cdots$ is a sum of distinct powers of 2.
      Then
      \begin{alignat*}{3}
        *2^{a_1} + *i
        &\equiv *2^{a_1} + *2^{b_1} + *2^{b_2} + \cdots
          & \text{(applying induction on $i$)} && \\
        &\equiv *(2^{a_1} + 2^{b_1} + 2^{b_2} + \cdots)
          & \qquad\quad \text{(applying induction on $2^{a_1} + i$)} && \\
        &\equiv *(2^{a_1} + i). & &&
      \end{alignat*}
      Since $0 \leq i < q$, the options of this type are equivalent to
      \[ \{*2^{a_1}, *(2^{a_1} + 1), \ldots, *\underbrace{(2^{a_1} + q - 1)}_{n - 1}\}. \]
  \end{enumcase}
  Combining the two types of options, we see that the options of $*2^{a_1} + *q$ are equivalent to
  the options of $*n$.
  By \cref{lem:4.2}, $*2^{a_1} + *q \equiv *n$.
\end{thmproof}

%%%%% Lec 7
\section{Sprague--Grundy Theorem}

So far: all Nim games are equivalent to a Nim game of a single pile.

Goal: extend this to all impartial games.

\subsection{Poker nim}

Being equivalent does not mean that two games play the same way.

\begin{ex}
  $*11 + *13 \equiv *6$.
  LHS: we want to move to $*11 + *11 \equiv *0$ by removing 2 chips from $*13$.
  RHS: remove all 6 chips.

  There are other moves in the game, however.
  Say we move to $*11 + *8 \equiv *15$.
  LHS: we remove 5 chips from $*13$.
  RHS: add 9 chips.

  Or, starting with $*11 + *11 \equiv *0$, any move on $*11 + *11$ will increase $*0$.
  Technically, adding chips is not allowed in Nim.
\end{ex}

\begin{defn}{poker nim}{poker_nim}
  A variation on Nim: \hldef{poker nim} consists of a regular Nim game plus a bag of $B$ chips.
  We now allow regular Nim moves and adding $B' \leq B$ chips to one pile.
\end{defn}

\begin{ex}
  In poker nim, $*3 + *4$ can move to $*53 + *4$ (assuming $B \geq 50$).
\end{ex}

How does this change the game of Nim?
It doesn't.

Say we face a losing game, so any regular Nim moves would lead to a loss.
In poker nim, we now add some chips to one pile.
The opposing play will simply remove the chips we placed, so nothing has changed.
Adding chips is not beneficial to any player.

When we say that a game is equivalent to a Nim game with one pile, it is actually a \emph{poker nim}
game with one pile.

\pagebreak
\subsection{Mex}

Suppose a game $G$ has options equivalent to $*0, *1, *2, *5, *10, *25$.
We claim that $G \equiv *3$.

The options of $*3$, which are $*0, *1, *2$, are all available to $G$.
If we add chips to $*3$, then the opposing player can just remove them to get back to $*3$.

How did we get $*3$?
It is the smallest non-negative integer that is not an option of $G$.

\begin{defn}{mex}{mex}
  Given a set of non-negative integers $S$, $\mex(S)$ is the smallest non-negative integer not in
  $S$.
  (Mex stands for ``minimum excluded integer''.)
\end{defn}

\begin{ex}
  $\mex(\{0, 1, 2, 5, 15, 25\}) = 3$.
\end{ex}

The mex function is the critical link between any impartial games and Nim games.

\begin{thm}{}{7.1}
  Let $G$ be an impartial game and let $S$ be the set of integers $n$ such that there exists an
  option of $G$ equivalent to $*n$.
  Then $G \equiv *(\mex(S))$.
\end{thm}

\begin{ex}
  $*1 + *1 + *2$ has options
  \begin{itemize}
    \item $*1 + *2 \equiv *3$,
    \item $*1 + *1 \equiv *0$, and
    \item $*1 + *1 + *1 \equiv *1$.
  \end{itemize}
  By \cref{thm:7.1}, $*1 + *1 + *2 \equiv *(\mex(\{0, 1, 3\})) \equiv *2$.
  (This is obvious by the copycat principle.)
\end{ex}

\begin{exer}{}{7.2}
  Prove that a game cannot be equivalent to one of its options.
\end{exer}

\begin{thmproof}[Proof (\cref{thm:7.1}).]
  Let $m = \mex(S)$.
  It suffices to show that $G + *m \equiv *0$ (\cref{lem:4.2}).
  \begin{enumcase}
    \item
      Suppose we move to $G + *m'$ where $m' < m$.
      Since $m = \mex(S)$, there exists an option $G'$ of $G$ such that $G' \equiv *m'$.
      Player II moves to $G' + *m'$, which is a losing game since $G' \equiv *m'$ (\cref{lem:4.2}).
    \item
      Suppose we move to $G' + *m$ where $G'$ is an option of $G$.
      Then $G' \equiv *k$ for some $k \in S$.
      So $G' + *m \equiv *k + *m \not\equiv *0$ since $k \neq \mex(S)$.
      So $G' + *m$ is a winning game for Player II.
      Then $G + *m$ is a losing game for Player I, so $G + *m \equiv *0$.
  \end{enumcase}
\end{thmproof}

\begin{thm}{Sprague--Grundy Theorem}{7.3}
  Any impartial game $G$ is equivalent to a poker nim game $*n$ for some $n$.
\end{thm}

\begin{thmproof}[Slightly sketchy proof.]
  If $G$ has no options, then $G \equiv *0$.
  Suppose $G$ has options $G_1, \ldots, G_k$.
  By induction, $G_i \equiv *n_i$ for some $n_i$.
  By \cref{thm:7.1}, $G \equiv *(\mex(\{n_1, \ldots, n_k\}))$.
\end{thmproof}

So any impartial game has a nimber.
How does this help?

%%%%% Lec 8
\section{Finding Nimo}

Finding nimbers is recursive:
\begin{itemize}
  \item Games with no options have nimber 0.
  \item Move backwards and use $\mex$ to determine other nimbers.
\end{itemize}

\begin{ex}
  Rook game.

  \begin{minipage}{0.4\textwidth}
    \centering
    \[
      \renewcommand{\arraystretch}{1.5}
      \begin{array}{c|c|c|c|c|c|}
        \multicolumn{1}{c}{} & \multicolumn{1}{c}{1} & \multicolumn{1}{c}{2} & \multicolumn{1}{c}{3}
          & \multicolumn{1}{c}{4} & \multicolumn{1}{c}{5} \\
        \cline{2-6}
        1 & *0 & *1 & *2 & *3 & \cellcolor{black!25} *4 \\
        \cline{2-6}
        2 & *1 & *0 & *3 & *2 & \cellcolor{black!25} *5 \\
        \cline{2-6}
        3 & *2 & *3 & *0 & *1 & \cellcolor{black!25} *6 \\
        \cline{2-6}
        4 & \cellcolor{black!25} *3 & \cellcolor{black!25} *2 & \cellcolor{black!25} *1
          & \cellcolor{black!25} *0 & \cellcolor{red!25}*7 \\
        \cline{2-6}
      \end{array}
    \]
  \end{minipage}\hfill
  \begin{minipage}{0.55\textwidth}
    Winning move: move to $(4, 4)$, an option with nimber 0.

    \vspace{\baselineskip}
    This is like a 2-pile Nim game.
  \end{minipage}
\end{ex}

\begin{ex}
  Substraction game (remove 1, 2, or 3 chips).
  Let $s_n$ be the nimber of a subtraction game with $n$ chips.
  Then $s_n = \mex(\{s_{n - 1}, s_{n - 2}, s_{n - 3}\})$ (if they exist).

  \[
    \begin{array}{c|c|c|c|c|c|c|c|c|c|c|c|c|c|c}
      n & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & \cdots \\
      \hline
      s_n & 0 & 1 & 2 & 3 & 0 & 1 & 2 & 3 & 0 & 1 & 2 & 3 & 0 & \cdots \\
    \end{array}
  \]

  We see a game is a losing game if and only if $n \equiv 0 \pmod{4}$.
  When $n \not\equiv 0 \pmod{4}$, a winning move is to remove just enough chips to get to the next
  multiple of 4.
  For example, if $n = 7$, remove 3 chips.
  (Equivalently, remove $s_n$ chips.)
\end{ex}

\begin{ex}
  Subtraction game with removing 2, 5, or 6 chips.
  Then $s_n = \mex(\{s_{n - 2}, s_{n - 5}, s_{n - 6}\})$ (if they exist).

  \begin{center}
    \begin{tabular}{c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c}
      $n$ & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & $\cdots$ \\
      \hline
      $s_n$ & 0 & 0 & 1 & 1 & 0 & 2 & 1 & 3 & 0 & 2 & 1 & 0 & 0 & 1 & 1 & $\cdots$ \\
      \multicolumn{1}{c}{} & \multicolumn{11}{c}{
        \raisebox{0.5\normalbaselineskip}{
          \clap{
            $\underbrace{
              \hphantom{\mbox{{0}{1}{2}{3}{4}{5}{6}{7}{8}{9}{10}\hspace*{
                \dimexpr25\arraycolsep+10\arrayrulewidth
              }}}
            }_{\text{repeats (not proved here)}}$
          }
        }
      } & \multicolumn{5}{c}{} \\
    \end{tabular}
  \end{center}

  A game is a losing game if and only if $n \equiv 0, 1, 4, 8 \pmod{11}$.

  For example, a winning move from 9 chips is to move to 4.
\end{ex}

\begin{ex}[Example: combining games]
  Let $G$ be the $4 \times 5$ rook game at $(4, 2)$.
  Let $H$ be the second subtraction game with $n = 7$.

  \begin{minipage}{0.45\textwidth}
    \centering
    \[
      \renewcommand{\arraystretch}{1.5}
      \begin{array}{c|c|c|c|c|c|}
        \multicolumn{1}{c}{} & \multicolumn{1}{c}{1} & \multicolumn{1}{c}{2} & \multicolumn{1}{c}{3}
          & \multicolumn{1}{c}{4} & \multicolumn{1}{c}{5} \\
        \cline{2-6}
        1 & *0 & *1 & *2 & *3 & *4 \\
        \cline{2-6}
        2 & *1 & *0 & *3 & *2 & *5 \\
        \cline{2-6}
        3 & *2 & *3 & *0 & *1 & *6 \\
        \cline{2-6}
        4 & *3 & \cellcolor{red!25} *2 & *1 & *0 & *7 \\
        \cline{2-6}
      \end{array}
    \]
  \end{minipage}\hfill
  \begin{minipage}{0.54\textwidth}
    \[
      \begin{array}{c|c|c|c|c|c|c|c|c}
        n & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\
        \hline
        s_n & 0 & 0 & 1 & 1 & 0 & 2 & 1 & \cellcolor{red!25} 3 \\
      \end{array}
    \]
  \end{minipage}

  \vspace{\baselineskip}
  Then $G \equiv *2$ and $H \equiv *3$, so $G + H \equiv *2 + *3 \equiv *1$, which is a winning
  game.

  The winning moves:
  \begin{itemize}
    \item
      From $H$, $3 \xor 1 = 2$.
      Move to $*2$.
      Remove 2 chips in the subtraction game.
    \item
      From $G$, $2 \xor 1 = 3$.
      Move to $*3$ (this may be surprising since the nimber increases, but it is entirely legal
      here).
      Move to $(4, 1)$ or $(3, 2)$.
  \end{itemize}
\end{ex}

Notes:
\begin{itemize}
  \item
    In general, there may not be a pattern for the nimbers of impartial games.
  \item
    Because of the recursive nature of nimbers, the search space becomes too large for many games.
  \item
    For impartial games in which we can find the nimbers, we can find winning moves by considering
    the nimbers.
\end{itemize}

%%%%% Topic: Strategic Games
\coursetopic{Strategic Games}

%%%%% Lec 9
\section{Strategic Games}

\subsection{Prisoner's dilemma}

Game show version: 2 players won \$10,000.
They each need to make a final decision: ``share'' or ``steal''.
\begin{itemize}
  \item If both pick ``share'', then they each win \$5,000.
  \item If one picks ``steal'' and the other picks ``share'', then the one who picked ``steal'' gets
  \$10,000 and the other gets nothing.
  \item If both pick ``steal'', then they each get a small consolation prize worth \$10.
\end{itemize}

This is an example of a strategic game.

How should the players behave?
The benefit a player receives is dependent on their own decision and the decisions of other players.

\begin{defn}{strategic game}{strategic_game}
  A \hldef{strategic game} is defined by specifying a set $N = \{1, \ldots, n\}$ of players where
  for each player $i \in N$, there is a set of possible strategies $S_i$ to play and a utility
  function $u_i : S_1 \times \cdots \times S_n \to \mathbb{R}$.
\end{defn}

\begin{ex}
  With the prisoner's dilemma above, $s_1 = s_2 = \{\text{share}, \text{steal}\}$.
  Samples of the utility functions: $u_1(\text{share}, \text{share}) = 5000$,
  $u_2(\text{steal}, \text{share}) = 0$.
  We can summarize the utility functions in a \hldef{payoff table}.

  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|}
      \multicolumn{2}{c}{} & \multicolumn{2}{c}{P II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{share} & \multicolumn{1}{c}{steal} \\
      \cline{3-4}
      \multirow{2}{*}{P I} & share & 5000, 5000 & 0, 10000 \\
      \cline{3-4}
      & steal & 10000, 0 & 10, 10 \\
      \cline{3-4}
    \end{tabular}
  \end{center}

  Each cell records the utilities of P I, P II in that order given the strategies played in that row
  (P I) and column (P II).
\end{ex}

\begin{enumerate}
  \item
    All players are rational and selfish (want to maximize their own utility).
  \item
    All players have knowledge of all game parameters (including rationality and selfishness).
  \item
    All players move simultaneously.
  \item
    Player $i$ plays a strategy $s_i \in S_i$, forming a strategy profile
    $s = (s_1, \ldots, s_n) \in S_1 \times \cdots \times S_n$.
    Player $i$ earns $u_i(s)$.
\end{enumerate}

\pagebreak
\subsection{Resolving the prisoner's dilemma}

Given a strategic game, what are we looking for?
One answer is we want to know how the players are expected to behave.

In the prisoner's dilemma, what would a rational and selfish player choose to play?

\begin{enumcase}
  \item
    If you know that the other player chooses ``share'', then choosing ``share'' gives 5000 while
    choosing ``steal'' gives 10000.
    ``Steal'' is better.
  \item
    If you know that the other player chooses ``steal'', then choosing ``share'' gives 0 while
    choosing ``steal'' gives 10.
    ``Steal'' is better.
\end{enumcase}

In both cases, it is better to steal than to share.
So we expect both player to choose ``steal''.

This is an example of a \hldef{strictly dominating} strategy: regardless of how other players
behave, this strategy gives the best utility over all other possible strategies.
If a strictly dominating strategy exists, then we expect the players to play it.

In this case, playing a strictly dominating strategy (``steal'') yields very little benefit.
The players could get more if there is some cooperation (both share).
So even though we expect the strictly dominating strategy to be played, it might not have the best
``social welfare'' (total utility of the players).

\pagebreak
\subsection{Nash equilibrium (NE)}

There are many games with no strictly dominating strategies.

\begin{ex}[Example: Bach or Stravinsky?]
  Two players want to go to a concert.
  Player I likes Bach while Player II likes Stravinsky, but they both prefer to be with each other.
  The payoff table looks like this:

  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|}
      \multicolumn{2}{c}{} & \multicolumn{2}{c}{P II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{Bach} & \multicolumn{1}{c}{Stravinsky} \\
      \cline{3-4}
      \multirow{2}{*}{P I} & Bach & 2, 1 & 0, 0 \\
      \cline{3-4}
      & Stravinsky & 0, 0 & 1, 2 \\
      \cline{3-4}
    \end{tabular}
  \end{center}

  No strictly dominating strategy exists for either player.
  What do we expect to happen?
  If both players choose ``Bach'', then there is no reason for one player to switch their strategy
  (which gives utility 0).
  The result is similar if both choose ``Stravinsky''.
\end{ex}

These are steady states, which we call \hldef{Nash equilibria}: strategy profiles where no player
is incentivized to change strategy.

\subsection{Mixed strategies}

There are many games with ``no'' Nash equilibria.

\begin{ex}[Example: rock, paper, scissors]
  R beats S, S beats P, P beats R.
  Let utilities be $1$ for a win, $0$ for a tie, and $-1$ for a loss.

  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|c|}
      \multicolumn{2}{c}{} & \multicolumn{3}{c}{P II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{R} & \multicolumn{1}{c}{P}
        & \multicolumn{1}{c}{S} \\
      \cline{3-5}
      \multirow{3}{*}{P I} & R & $0, 0$ & $-1, 0$ & $1, -1$ \\
      \cline{3-5}
      & P & $1, -1$ & $0, 0$ & $-1, 1$ \\
      \cline{3-5}
      & S & $-1, 1$ & $1, -1$ & $0, 0$ \\
      \cline{3-5}
    \end{tabular}
  \end{center}
\end{ex}

%%%%% Lec 10
\section[Nash Equilibrium and the Best Response Function]{%
  Nash Equilibrium and the Best Response \\ Function
}

\subsection{Notation}

Let $S = S_1 \times \cdots S_n$ be the set of all strategy profiles.
We will often compare the utilities of a player's strategies when we fix the strategies of the
remaining players.
Let $S_{-i}$ be the set of all strategy profiles of all players except player $i$ (we drop $S_i$
from the cartesian product $S_1 \times \cdots \times S_n$).
If $s \in S$, then the profile obtained from $s$ by dropping $s_i$ is denoted $s_{-i} \in S_{-i}$.
If player $i$ switches their strategy from $s_i$ to $s_i^{\prime}$, then the new strategy profile
is denoted $(s_i^{\prime}, s_{-i}) \in S$.

\subsection{Nash equilibrium}

Recall: a Nash equilibrium is a strategy profile where no player is incentivized to switch
strategies.

\begin{defn}{Nash equilibrium}{nash_eq}
  A strategy profile $s^* \in S$ is a \hldef{Nash equilibrium} if
  $u_i(s^*) \geq u_i(s_i^{\prime}, s_{-i}^*)$ for all $s_i^{\prime} \in S_i$ and for all $i \in N$.
\end{defn}

\begin{ex}[Example: prisoner's dilemma revisited]
  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|}
      \multicolumn{2}{c}{} & \multicolumn{2}{c}{P II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{share} & \multicolumn{1}{c}{steal} \\
      \cline{3-4}
      \multirow{2}{*}{P I} & share & 5000, 5000 & 0, 10000 \\
      \cline{3-4}
      & steal & 10000, 0 & 10, 10 \\
      \cline{3-4}
    \end{tabular}
  \end{center}

  Let $s^* = (\text{steal}, \text{steal})$.

  For Player I: $u_1(s^*) = 10$,
  $u_1(\underbrace{\text{share}}_{s_1^{\prime}}, \underbrace{\text{steal}}_{s_{-1}^*})
    = 0 < u_1(s^*)$.

  Similar for Player II.
  Thus $s^*$ is an NE.
\end{ex}

\begin{ex}[Example: guessing $\frac{2}{3}$ average game]
  There are three players and a positive integer $k$.
  The players each simultaneously pick an integer from $\{1, \ldots, k\}$, producing the strategy
  profile $s = (s_1, s_2, s_3)$.
  There is \$1 which is split among all players whose choices are closest to $\frac{2}{3}$ of the
  average of the three numbers.
  The other players get \$0.

  If $s = (5, 2, 4)$, then the average is $\frac{11}{3}$, and $\frac{2}{3}$ of the average is
  $\frac{22}{9} = 2 + \frac{4}{9}$.
  Player II is the closest, so $u_2(s) = 1$ and $u_1(s) = u_3(s) = 0$.

  Is $s$ an NE?
  No: if Player II switches to 2, then $u_1(2, s_{-1}) = u_1(2, 2, 4) = \frac{1}{2}$ ($\frac{2}{3}$
  of the average is now $\frac{16}{9}$, which is closer to 2 than to 4).

  Is there an NE in this game?
  Idea: lowering your guess generally pulls $\frac{2}{3}$ of the average closer to your guess.
  Try $(1, 1, 1)$.
  If a player switches to $t \geq 2$, then $\frac{2}{3}$ of the average is
  $\frac{4 + 2t}{9} = \frac{4}{9} + \frac{2}{9}t$, which is closer to 1 than to $t$.
\end{ex}

\begin{exer}{}{10.1}
  Prove that $(1, 1, 1)$ is the only NE of this game.
\end{exer}

\pagebreak
\subsection{Best response function (BRF)}

For an NE, a player does not want to switch.
If you fix the strategies of the remaining players, then you play a strategy that maximizes utility
for yourself, \emph{i.e.}, it is a ``best response'' to the fixed strategies.

\begin{defn}{best response function (BRF)}{brf}
  Player $i$'s \hldef{best response function} for $s_{-i} \in S_{-i}$ is given by
  \[
    B_i(s_{-i}) = \{ s_i^{\prime} \in S_i :
      u_i(s_i^{\prime}, s_{-i}) \geq u_i(s_i, s_{-i}) \ \forall s_i \in S_i
    \}.
  \]
  That is, the utility of a best response is greater than or equal to the utilities of all possible
  responses to $s_{-i}$.
\end{defn}

\begin{ex}
  In the prisoner's dilemma: $B_1(\text{share}) = \{ \text{steal} \}$,
  $B_1(\text{steal}) = \{ \text{steal} \}$.
\end{ex}

\begin{ex}
  In the $\frac{2}{3}$ average game, $B_1(5, 5) = \{ 1, 2, 3, 4 \}$:
  \[
    u_1(x, 5, 5) = \begin{cases}
      1 \qquad &\text{if } \ x < 5 \\
      \frac{1}{3} \qquad &\text{if } \ x = 5 \\
      0 \qquad &\text{if } \ x > 5 \\
    \end{cases}
  \]
\end{ex}

If $s^*$ is an NE, then each player $i$ must have played a best response to $s_{-i}^*$.
Changing $s_i^*$ cannot increase the utility for $i$.
The converse is also true.

\begin{lem}{}{10.2}
  $s^* \in S$ is a Nash equilibrium if and only if $s_i^* \in B_i(s_{-i}^*)$ for all $i \in N$.
\end{lem}

\begin{thmproof}[Proof (exercise: see P8(a)).]
  \begin{itemize}[leftmargin=4em]
    \item[($\implies$)]
      Here, $s^* \in S$ is a Nash equilibrium.
      By definition of a Nash equilibrium, $u_i(s^*) \geq u_i(s_i, s_{-i}^*)$ for all $s_i \in S_i$
      and for all $i \in N$.
      Then note $s^* = (s_i^*, s_{-i}^*)$, so equivalently
      $u_i(s_i^*, s_{-i}^*) \geq u_i(s_i, s_{-i}^*)$ for all $s_i \in S_i$ and for all $i \in N$.
      By definition of the BRF, $s_i^* \in B_i(s_{-i}^*)$ for all $i \in N$.
    \item[($\impliedby$)]
      Here, $s_i^* \in B_i(s_{-i}^*)$ for all $i \in N$.
      By definition of the BRF, every $s_i^*$ satisfies
      $u_i(s_i^*, s_{-i}^*) \geq u_i(s_i, s_{-i}^*) \ \forall s_i \in S_i$.
      But $(s_i^*, s_{-i}^*) = s^*$, so $u_i(s^*) \geq u_i(s_i, s_{-i}^*)$ for all $s_i \in S_i$ and
      for all $i \in N$.
      By definition of a Nash equilibrium, $s^*$ is a Nash equilibrium.
  \end{itemize}
\end{thmproof}

This lemma helps us find NEs by looking for strategies in the BRF.

\begin{ex}
  In the prisoner's dilemma payoff table, we mark best responses for each player:
  \begin{itemize}
    \item[$\star$:] $B_1(\text{share}) = \{\text{steal}\}$, $B_1(\text{steal}) = \{\text{steal}\}$
    \item[$\dagger$:] $B_2(\text{share}) = \{\text{steal}\}$, $B_2(\text{steal}) = \{\text{steal}\}$
  \end{itemize}

  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|}
      \multicolumn{2}{c}{} & \multicolumn{2}{c}{P II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{share} & \multicolumn{1}{c}{steal} \\
      \cline{3-4}
      \multirow{2}{*}{P I} & share & 5000, 5000 & $0, 10000^{\dagger}$ \\
      \cline{3-4}
      & steal & $10000^{\star}, 0$ & $10^{\star}, 10^{\dagger}$ \\
      \cline{3-4}
    \end{tabular}
  \end{center}

  $(\text{steal}, \text{steal})$ is a strategy profile where all strategies are best responses to
  each other, so it is an NE.
\end{ex}

\begin{ex}
  Consider this arbitrary game.
  Find the BRFs and NEs.

  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|c|}
      \multicolumn{2}{c}{} & \multicolumn{3}{c}{P II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{$X$} & \multicolumn{1}{c}{$Y$}
        & \multicolumn{1}{c}{$Z$} \\
      \cline{3-5}
      \multirow{3}{*}{P I} & $A$ & $1, 2$ & $2, 1$ & $1, 0$ \\
      \cline{3-5}
      & $B$ & $2, 1$ & $0, 1$ & $0, 0$ \\
      \cline{3-5}
      & $C$ & $0, 1$ & $0, 0$ & $1, 2$ \\
      \cline{3-5}
    \end{tabular}
  \end{center}

  BRFs:
  \begin{itemize}
    \item[$\star$:] $B_1(X) = \{ B \}, \ \ B_1(Y) = \{ A \}, \ \ B_1(Z) = \{ A, C \}$
    \item[$\dagger$:] $B_2(A) = \{ X \}, \ \ B_2(B) = \{ X, Y \}, \ \ B_2(C) = \{ Z \}$
  \end{itemize}

  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|c|}
      \multicolumn{2}{c}{} & \multicolumn{3}{c}{P II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{$X$} & \multicolumn{1}{c}{$Y$}
        & \multicolumn{1}{c}{$Z$} \\
      \cline{3-5}
      \multirow{3}{*}{P I} & $A$ & $1, 2^\dagger$ & $2^\star, 1$ & $1^\star, 0$ \\
      \cline{3-5}
      & $B$ & $2^\star, 1^\dagger$ & $0, 1^\dagger$ & $0, 0$ \\
      \cline{3-5}
      & $C$ & $0, 1$ & $0, 0$ & $1^\star, 2^\dagger$ \\
      \cline{3-5}
    \end{tabular}
  \end{center}

  The NEs are $(B, X)$ and $(C, Z)$ as the strategies are best responses to each other.
  The rest are not NEs as one strategy is not a best response to the other.
\end{ex}

%%%%% Lec 11
\section{Cournot's Oligopoly Model}

We have a set $N = \{1, \ldots, n\}$ of $n$ firms producing a single type of goods sold on the
common market.
Each firm $i$ needs to decide the number of units of goods $q_i$ to produce.
Production cost is $C_i(q_i)$ where $C_i$ is a given increasing function.
Given a strategy profile $q = (q_1, \ldots, q_n)$, a unit of the goods sell for the price of $P(q)$,
where $P$ is a given non-increasing function on $\sum_i q_i$ (that is, more goods means a
lower price).
The utility of firm $i$ in the strategy profile $q$ is $u_i(q) = q_i P(q) - C_i(q_i)$.

Szidarovsky and Yakowitz proved that a Nash equilibrium always exists under some continuity and
differentiability assumptions on $P$ and $C$.

\subsection{Special case: linear costs and prices}

Suppose we assume $C_i(q_i) = c q_i \ \forall i \in N$ (the cost is linear with the same unit cost
$c$ for all firms) and $P(q) = \max\{0, \alpha - \sum_j q_j\}$ (price starts at $\alpha$,
decreases by 1 for each unit produced, and has minimum 0) where $0 < c < \alpha$.

The utility is
\[
  u_i(q) = q_i P(q) - C_i(q_i) = \begin{cases}
    q_i (\alpha - c - \sum_j q_j) \qquad &\text{if } \ \alpha - \sum_j q_j \geq 0 \\
    -c q_i &\text{if } \ \alpha - \sum_j q_j < 0
  \end{cases}.
\]
When is it possible to make a profit?
When $\alpha - c - \sum_j q_j > 0$.

Separate $q_i$ from the sum: $\alpha - c - q_i - \sum_{j \neq i} q_j > 0$, so
$q_i < \alpha - c - \sum_{j \neq i} q_j$.
This does not make sense for $q_i$ if RHS $\leq 0$, so assume RHS $> 0$.

The utility is then $q_i(\alpha - c - q_i - \sum_{j \neq i} q_j)$.
Treating $q_i$ as the variable, this utility is maximized when
$q_i = \frac{1}{2}(\alpha - c - \sum_{j \neq i} q_j)$ (use calculus).
The best response function for firm $i$ given the production of the other firms $q_{-i}$ is then
\[
  B_i(q_{-i}) = \begin{cases}
    \{ \frac{1}{2} (\alpha - c - \sum_{j \neq i} q_j) \}
      \qquad &\text{if } \alpha - c - \sum_{j \neq i} q_j > 0 \\
    \{ 0 \} &\text{otherwise}
  \end{cases}.
\]

\subsection{Two-firm case}

Suppose we simplify to 2 firms.
Suppose $q^* = (q_1^*, q_2^*)$ is a Nash equilibrium.
By \cref{lem:10.2}, a player's choice must be the best response to the other player's choice.
So $q_1^* \in B_1(q_2^*)$ and $q_2^* \in B_2(q_1^*)$.
Verify that we may assume $q_1^*, q_2^* > 0$.
Then $q_1^* = \frac{1}{2}(\alpha - c - q_2^*)$ and $q_2^* = \frac{1}{2}(\alpha - c - q_1^*)$.
Solving this gives $q_1^* = q_2^* = \frac{1}{2}(\alpha - c)$.
This is the amount we expect each firm to produce at equilibrium.
The price at equilibrium is then
\[
  P(q^*) = \alpha - q_1^* - q_2^* = \alpha - \frac{2}{3}(\alpha - c)
    = \frac{1}{3}\alpha + \frac{2}{3}c
\]
and the profit at equilibrium is
\[
  u_i(q^*) = q_i^*(\alpha - c - q_1^* - q_2^*) = \frac{1}{9}(\alpha - c)^2.
\]

Note 1: Suppose the two firms can collude, and together they produce $Q$ units in total.
The total profit is then $Q(\alpha - c - Q)$, which is maximized at $Q = \frac{1}{2}(\alpha - c)$.
The profit is then
$\frac{1}{2}(\alpha - c)(\alpha - c - \frac{1}{2}(\alpha - c)) = \frac{1}{4}(\alpha - c)^2$.
Each firm gets $\frac{1}{8}(\alpha - c)^2 > \frac{1}{9}(\alpha - c)^2$.

Note 2: In the general case with $n$ firms, if $q^*$ is an NE, then
$q_i^* = \frac{1}{2}(\alpha - c - \sum_{j \neq i} q_j^*)$.
Solving this system gives $q_i^* = \frac{\alpha - c}{n + 1}$.
The price is $P(q^*) = \alpha - \sum_j q_j^* = \alpha - \frac{n}{n + 1}(\alpha - c)
  = \frac{1}{n + 1}\alpha + \frac{n}{n + 1}c$.
As $n \to \infty$, $P(q^*) \to c$.
As more firms are involved, the expected market price gets closer to the production cost.

%%%%% Lec 12
\section{Strict Dominance}

\begin{defn}{strict dominance}{strict_dominance}
  For two strategies $s_i^{(1)}, s_i^{(2)} \in S_i$ for player $i$, we say that $s_i^{(1)}$
  \hldef{strictly dominates} $s_i^{(2)}$ if for all $s_{-i} \in S_{-i}$,
  $u_i(s_i^{(1)}, s_{-i}) > u_i(s_i^{(2)}, s_{-i})$.

  If there exists a strategy that strictly dominates $s_i$, then $s_i$ is
  \hldef{strictly dominated}.
  If $s_i$ strictly dominates all strategies $s_i^\prime \in S_i \setminus \{ s_i \}$, then $s_i$ is
  a \hldef{strictly dominating strategy}.
\end{defn}

In prisoner's dilemma, ``steal'' is a strictly dominating strategy for both players.

\begin{lem}{}{12.1}
  If $s_i \in S_i$ is a strictly dominating strategy for player $i$ and $s^* \in S$ is a Nash
  equilibrium, then $s_i^* = s_i$.
\end{lem}

In other words: in any NE, the strictly dominating strategy is played whenever it exists.
A game is easy to play if such a strategy exists.

We now look at strictly dominated strategies.

\begin{ex}
  Consider the following strategic game:

  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|c|c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$X$} & \multicolumn{1}{c}{$Y$}
        & \multicolumn{1}{c}{$Z$} \\
      \cline{2-4}
      $A$ & $4, 2$ & $1, 3$ & $2, 1$ \\
      \cline{2-4}
      $B$ & $2, 3$ & $0, 1$ & $3, 1$ \\
      \cline{2-4}
    \end{tabular}
  \end{center}

  $Z$ is strictly dominated by $X$ since $u_2(A, X) > u_2(A, Z)$ and $u_2(B, X) > u_2(B, Z)$.
  $Z$ is a strictly dominated strategy, so there is no reason to play it.
\end{ex}

\begin{lem}{}{12.2}
  If $s^* \in S$ is a Nash equilibrium, then $s_i^*$ is not strictly dominated for any $i \in N$.
\end{lem}

\pagebreak
\subsection{Iterated elimination of strictly dominated strategies (IESDS)}

\begin{ex}
  \begin{minipage}{0.4\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|c|c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$X$} & \multicolumn{1}{c}{$Y$}
        & \multicolumn{1}{c}{$Z$} \\
      \cline{2-4}
      $A$ & $4, 2$ & $1, 3$ & $2, 1$ \\
      \cline{2-4}
      $B$ & $2, 3$ & $0, 1$ & $3, 1$ \\
      \cline{2-4}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.6\textwidth}
    $Z$ is strictly dominated, so it will not appear in any NE.
  \end{minipage}

  \hspace{0.20\textwidth} \scalebox{2}{$\downarrow$} \quad eliminate $Z$

  \begin{minipage}{0.4\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$X$} & \multicolumn{1}{c}{$Y$} \\
      \cline{2-3}
      $A$ & $4, 2$ & $1, 3$ \\
      \cline{2-3}
      $B$ & $2, 3$ & $0, 1$ \\
      \cline{2-3}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.6\textwidth}
    $B$ is strictly dominated.
    (Notice this is new in this smaller game.)
  \end{minipage}

  \hspace{0.20\textwidth} \scalebox{2}{$\downarrow$} \quad eliminate $B$

  \begin{minipage}{0.4\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$X$} & \multicolumn{1}{c}{$Y$} \\
      \cline{2-3}
      $A$ & $4, 2$ & $1, 3$ \\
      \cline{2-3}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.6\textwidth}
    $X$ is strictly dominated.
  \end{minipage}

  \hspace{0.20\textwidth} \scalebox{2}{$\downarrow$} \quad eliminate $X$

  \begin{minipage}{0.4\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$Y$} \\
      \cline{2-2}
      $A$ & $1, 3$ \\
      \cline{2-2}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.6\textwidth}
    Is this an NE?
    (Yes.)
  \end{minipage}
\end{ex}

IESDS: Repeatedly eliminate strictly dominated strategies until we have only one strategy profile.
We claim that if this works, then the surviving profile is the unique NE of the game.

\begin{ex}[Example: facility location game]
  Two firms are each given a permit to open one store in one of six towns along a highway.
  Firm I can open in A, C, or E; Firm II can open in B, D, or F.

  \begin{center}
    \begin{forest}
      for tree={{grow=east, circle, draw}}
      [A [B [C [D [E [F]]]]]]
    \end{forest}
  \end{center}

  Assume towns are equally spaced and equally populated.
  Customers in a town will go to the closest store.
  Where should the firms open the stores?

  Apply IESDS:

  \begin{minipage}{0.5\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|c|}
      \multicolumn{2}{c}{} & \multicolumn{3}{c}{Firm II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{B} & \multicolumn{1}{c}{D}
        & \multicolumn{1}{c}{F} \\
      \cline{3-5}
      \multirow{3}{*}{Firm I} & A & $1, 5$ & $2, 4$ & $3, 3$ \\
      \cline{3-5}
      & C & $4, 2$ & $3, 3$ & $4, 2$ \\
      \cline{3-5}
      & E & $3, 3$ & $2, 4$ & $5, 1$ \\
      \cline{3-5}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.5\textwidth}
    Firm I: A is strictly dominated by C.

    Firm II: F is strictly dominated by D.
  \end{minipage}

  \hspace{0.3\textwidth} \scalebox{2}{$\downarrow$} \quad eliminate A and F

  \begin{minipage}{0.5\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|c|}
      \multicolumn{2}{c}{} & \multicolumn{2}{c}{Firm II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{B} & \multicolumn{1}{c}{D} \\
      \cline{3-4}
      \multirow{2}{*}{Firm I} & C & $4, 2$ & $3, 3$ \\
      \cline{3-4}
      & E & $3, 3$ & $2, 4$ \\
      \cline{3-4}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.5\textwidth}
    Firm I: E is strictly dominated by C.

    Firm II: B is strictly dominated by D.
  \end{minipage}

  \hspace{0.3\textwidth} \scalebox{2}{$\downarrow$} \quad eliminate B and E

  \begin{minipage}{0.5\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c c |c|}
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{Firm II} \\
      \multicolumn{2}{c}{} & \multicolumn{1}{c}{D} \\
      \cline{3-3}
      \multirow{1}{*}{Firm I} & C & $3, 3$ \\
      \cline{3-3}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.5\textwidth}
    (C, D) is an NE.
  \end{minipage}
\end{ex}

Note: We can extend this to 1000 towns with alternating options.
The two ends are strictly dominated by the centre towns.
eliminate them to get 998 towns.
Repeat.
End with the two towns in the centre as the NE.

\pagebreak
\subsection{Results in IESDS}

\begin{thm}{}{12.3}
  Suppose $G$ is a strategic game.
  If IESDS ends with only one strategy profile $s^*$, then $s^*$ is the unique Nash equilibrium of
  $G$.
\end{thm}

This is a consequence of the following result.

\begin{thm}{}{12.4}
  Let $G$ be a strategic game where $s_i$ is a strictly dominated strategy for player $i$.
  Let $G'$ be obtained from $G$ by removing $s_i$ from $S_i$.
  Then $s^*$ is a Nash equilibrium of $G$ if and only if $s^*$ is a Nash equilibrium of $G'$.
\end{thm}

\begin{thmproof}[Proof sketch.]
  \begin{itemize}[leftmargin=4em]
    \item[($\implies$)]
      Suppose $s^*$ is an NE of $G$.
      Since $s_i$ is strictly dominated, it cannot appear in $s^*$ (\cref{lem:12.2}).
      So $s^*$ is a valid strategy in $G'$.
      If $s^*$ is not an NE of $G'$, then a player can deviate to get a higher utility.
      However, all strategies in $G'$ are available in $G$, so such a player can do it in $G$ as
      well.
      This contradicts $s^*$ being an NE of $G$.
    \item[($\impliedby$)]
      Suppose $s^*$ is an NE of $G'$.
      Suppose $s^*$ is not an NE in $G$.
      Then a player can deviate to get a higher utility.
      This can be replicated in $G'$ (which results in a contradiction) unless it is player $i$
      switching to strategy $s_i$ (the only strategy in $G$ not in $G'$).
      Then player $i$ could switch to the strategy that strictly dominates $s_i$ (available in $G'$)
      to get a higher utility in $G'$.
      This contradicts $s^*$ being an NE in $G'$.
  \end{itemize}
\end{thmproof}

%%%%% Lec 13
\section{Weak Dominance}

\begin{defn}{weak dominance}{weak_dominance}
  For two strategies $s_i^{(1)}, s_i^{(2)} \in S_i$ for player $i$, we say that $s_i^{(1)}$
  \hldef{weakly dominates} $s_i^{(2)}$ if for all $s_{-i} \in S_{-i}$,
  $u_i(s_i^{(1)}, s_{-i}) \geq u_i(s_i^{(2)}, s_{-i})$, and this inequality is strict for at least
  one $s_{-i} \in S_{-i}$.

  If there exists a strategy that weakly dominates $s_i$, then $s_i$ is
  \hldef{weakly dominated}.
  If $s_i$ weakly dominates all strategies $s_i^\prime \in S_i \setminus \{ s_i \}$, then $s_i$ is
  a \hldef{weakly dominating strategy}.
\end{defn}

\begin{ex}
  Consider this strategic game:
  \begin{center}
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|c|c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$X$} & \multicolumn{1}{c}{$Y$}
        & \multicolumn{1}{c}{$Z$} \\
      \cline{2-4}
      $A$ & $3, 3$ & $1, 1$ & $4, 1$ \\
      \cline{2-4}
      $B$ & $2, 1$ & $0, 1$ & $3, 1$ \\
      \cline{2-4}
    \end{tabular}
  \end{center}

  $Z$ is weakly dominated by $X$ since $u_2(A, X) > u_2(A, Z)$ and $u_2(B, X) \geq u_2(B, Z)$.

  $Z$ is not weakly dominated by $Y$ since there is no case with strict inequality.
\end{ex}

\pagebreak
\subsection{Iterated elimination of weakly dominated strategies (IEWDS)}

Remove weakly dominated strategies until there is only one strategy profile.

\begin{ex}
  \begin{minipage}{0.4\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|c|c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$X$} & \multicolumn{1}{c}{$Y$}
        & \multicolumn{1}{c}{$Z$} \\
      \cline{2-4}
      $A$ & $3, 3$ & $1, 1$ & $4, 1$ \\
      \cline{2-4}
      $B$ & $2, 1$ & $0, 1$ & $3, 1$ \\
      \cline{2-4}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.6\textwidth}
    $Y$ and $Z$ are weakly dominated by $X$.
  \end{minipage}

  \hspace{0.2\textwidth} \scalebox{2}{$\downarrow$} \quad eliminate $Y$ and $Z$

  \begin{minipage}{0.4\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$X$} \\
      \cline{2-2}
      $A$ & $3, 3$ \\
      \cline{2-2}
      $B$ & $2, 1$ \\
      \cline{2-2}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.6\textwidth}
    $B$ is weakly dominated by $A$.
  \end{minipage}

  \hspace{0.2\textwidth} \scalebox{2}{$\downarrow$} \quad eliminate $B$

  \begin{minipage}{0.4\textwidth}
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{c |c|}
      \multicolumn{1}{c}{} & \multicolumn{1}{c}{$X$} \\
      \cline{2-2}
      $A$ & $3, 3$ \\
      \cline{2-2}
    \end{tabular}
  \end{minipage}\hfill\begin{minipage}{0.6\textwidth}
    $(A, X)$ is an NE.
  \end{minipage}
\end{ex}

\begin{thm}{}{13.1}
  Suppose $G$ is a strategic game.
  If IEWDS ends with only one strategy profile $s^*$, then $s^*$ is a Nash equilibrium of $G$.
\end{thm}

Note: Compare with \cref{thm:12.3}---here, we can no longer claim that the NE is unique.
A different sequence of eliminations can result in a different NE.

\begin{ex}
  In the payoff table above, eliminating $Y$ then $B$ then $X$ gives a different NE, $(A, Z)$.
\end{ex}

Key difference: unlike strictly dominated strategies, weakly dominated strategies can appear in an
NE.

\begin{minipage}{0.6\textwidth}
  Some NE cannot be found through IEWDS: \emph{e.g.}, Bach or Stravinsky has no weakly dominated
  strategies.
\end{minipage}\hfill\begin{minipage}{0.4\textwidth}
  \centering
  \renewcommand{\arraystretch}{1.25}
  \begin{tabular}{c |c|c|}
    \multicolumn{1}{c}{} & \multicolumn{1}{c}{B} & \multicolumn{1}{c}{S} \\
    \cline{2-3}
    B & $2, 1$ & $0, 0$ \\
    \cline{2-3}
    S & $0, 0$, & $2, 1$ \\
    \cline{2-3}
  \end{tabular}
\end{minipage}

\pagebreak
\subsection{Weakly dominating strategies}

Just like strictly dominating strategies, weakly dominating strategies are good to play.

\begin{lem}{}{13.2}
  If for all players $i$, $s_i^*$ is a weakly dominating strategy, then $s^*$ is a Nash equilibrium.
\end{lem}

%%%%% Lec 14
\section{Auctions}

Setup of an auction: A seller puts one item up for an auction.
Potential buyers put in bids to buy the item.
The seller decides who wins (usually highest bidder) and the price they pay.

Typical auction: open bid auction.
Buyers bid repeatedly until no one else bids.
Highest bid wins and pays their bid price.

Another type: closed bid auction.
Each buyer submits one secret bid to the seller.
(Easier to analyze.)

First price auction: highest bid wins, winner pays their bid.
(If three bidders bid 150, 100, and 200, the third bidder wins and pays 200.)
Does this simulate an open auction?
No---in the open auction setting, the winner will bid slightly over 150 and win, so they would
actually pay closer to 150.

Second price auction: highest bid wins, winner pays second highest bid.
(If three bidders bid 150, 100, and 200, the third bidder wins and pays 150.)
This better simulates an open auction.

We will analyze second price closed bid auctions.

Setup: we have buyers $N = \{ 1, \ldots, n \}$.
Buyer $i$ thinks the item has value $v_i$ (``valuation'').
Suppose buyer $i$ submits bid $b_i$, giving strategy profile $b = (b_1, \ldots, b_n)$.
The winner is the buyer who submits the highest bid; they pay a price equal to the second highest
bid.
If there is a tie, then the winner is the buyer with the lowest index $i$ among all tied buyers.

Given a strategy profile $b$, the utility for buyer $i$ is
\[
  u_i(b) = \begin{cases}
    v_i - \displaystyle\max_{j \neq i} b_j \qquad & i \text{ wins in } b \\
    0 & \text{otherwise}
  \end{cases}.
\]

Suppose your valuation of the item is 100.
Would you bid anything other than 100?
\begin{enumcase}
  \item
    Your bid wins.
    \[
      24, \ 69, \ 75, \ \mathbf{100}
    \]
    Pay 75, get utility 25.

    If you bid more than 75, you still win, you still pay 75.
    If you bid less than 75, you lose and get utility 0.
  \item
    Your bid loses.
    \[
      24, \ 69, \ 75, \ \mathbf{100}, \ 121
    \]
    Your utility is 0.

    If you bid less than 121, you still lose and you still get utility 0.
    If you bid more than 121, you win, but you pay 121 and get utility $-21$.
\end{enumcase}
In all cases, your utility does not increase if you bid anything else than your valuation.

\begin{thm}{}{14.1}
  In the second price auction, $v_i$ is a weakly dominating strategy for player $i \in N$.
\end{thm}

\begin{thmproof}
  We first show that $u_i(v_i, b_{-i}) \geq u_i(b_i, b_{-i})$ for all $b_i \in S_i$ and
  $b_{-i} \in S_{-i}$.
  There are two cases.
  \begin{enumcase}
    \item
      $v_i$ is a winning bid in $(v_i, b_{-i})$.

      Let $b_j$ be the second highest bid (which could equal $v_i$).
      The utility for player $i$ is $u_i(v_i, b_{-i}) = v_i - b_j \geq 0$.
      Suppose player $i$ changes their bid to $b_i$.

      If $b_i > b_j$ or ($b_i = b_j$ and $i < j$), then $b_i$ is still the winning bid in
      $(b_i, b_{-i})$.
      Payment is still $b_j$, so the utility remains the same.

      Otherwise, $b_i$ is a losing bid, so the utility is 0, which is at most $u_i(v_i, b_{-i})$.

      So $u_i(v_i, b_{-i}) \geq u_i(b_i, b_{-i})$ for any $b_i$.
    \item
      $v_i$ is a losing bid in $(v_i, b_{-i})$.

      Let $b_j$ be the winning bid (so $b_j \geq v_i$).
      The utility for player $i$ is $u_i(v_i, b_{-i}) = 0$.
      Suppose player $i$ changes their bid to $b_i$.

      If $b_i < b_j$ or ($b_i = b_j$ and $i > j$), then $b_i$ is still a losing bid in
      $(b_i, b_{-i})$.
      The utility is still 0.

      Otherwise, $b_i$ is a winning bid with payment $b_j$.
      The utility is $u_i(b_i, b_{-i}) = v_i - b_j \leq 0$ (since $b_j \geq v_i$).

      So $u_i(v_i, b_{-i}) \geq u_i(b_i, b_{-i})$.
  \end{enumcase}
  In both cases, bidding $v_i$ gives the highest utility among all possible bids of player $i$.

  We still need to show that for all $b_i \neq v_i$, there exists $s_{-i} \in S_{-i}$ such that
  $u_i(v_i, b_{-i}) > u_i(b_i, b_{-i})$.
  There are two cases.
  \begin{enumcase}
    \item
      Suppose $b_i < v_i$.

      Let $k$ be in $b_i < k < v_i$.
      Set $b_j = k$ for all $j \neq i$.
      When $v_i$ is played against $b_{-i}$, player $i$ wins ($v_i > k$) and pays $k$.
      The utility is then $u_i(v_i, b_{-i}) = v_i - k > 0$.
      When $b_i$ is played against $b_{-i}$, player $i$ loses ($b_i < k$) and the utility is
      $u_i(b_i, b_{-i}) = 0$.
      So $u_i(v_i, b_{-i}) > u_i(b_i, b_{-i})$.
    \item
      Suppose $b_i > v_i$.

      Let $k$ be in $v_i < k < b_i$.
      Set $b_j = k$ for all $j \neq i$.
      When $v_i$ is played against $b_{-i}$, player $i$ loses ($v_i < k$) and the utility is
      $u_i(v_i, b_{-i}) = 0$.
      When $b_i$ is played against $b_{-i}$, player $i$ wins ($b_i > k$) and pays $k$.
      The utility is $u_i(b_i, b_{-i}) = v_i - k < 0$.
      So $u_i(v_i, b_{-i}) > u_i(b_i, b_{-i})$.
  \end{enumcase}
  Therefore, playing $v_i$ is a weakly dominating strategy.
\end{thmproof}

Note: The way we play this game does not depend on knowing how other players value the item, so it
is easy to play---simply bid your valuation.

Usually, strategic games require you to know all the information to play perfectly.
However, this game does not.

\begin{exer}{}{14.2}
  Suppose buyer 1 has the highest valuation $v_1$ and buyer 2 has the second highest valuation
  $v_2$.
  Show that $(v_2, v_1, 0, 0, \ldots, 0)$ is a NE.
\end{exer}

%---------------
\end{document}
%---------------
